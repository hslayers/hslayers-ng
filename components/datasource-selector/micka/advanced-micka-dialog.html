<div [ngClass]="{'in': modalVisible}" class="modal hs-ds-advanced-micka" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" i18n>
                    Extended search parameters for Micka
                </h4>
                <button type="button" (click)="modalVisible = false" class="close" data-dismiss="modal"><span
                        aria-hidden="true">&times;</span><span class="sr-only" i18n>Close</span></button>
            </div>
            <div class="modal-body" style="max-height:600px; overflow-y:auto">
                <form>
                    <label class="form-group">
                        <i18n class="control-label">Fulltext</i18n>
                        <input type="text" class="form-control"
                            [(ngModel)]="datasourceSelectorService.data.query.textFilter" />
                    </label>
                    <div>
                        <label class="radio-inline">
                            <input type="radio" [(ngModel)]="datasourceSelectorService.data.textField" value="AnyText">
                            All
                        </label>
                        <label class="radio-inline">
                            <input type="radio" [(ngModel)]="datasourceSelectorService.data.textField" value="title">
                            Title
                        </label>
                        <label class="radio-inline">
                            <input type="radio" [(ngModel)]="datasourceSelectorService.data.textField" value="abstract">
                            Abstract
                        </label>
                    </div>

                    <label class="form-group">
                        <i18n class="control-label">Keywords</i18n>
                        <div class="input-group">
                            <input type="text" class="form-control"
                                [(ngModel)]="datasourceSelectorService.data.query.keywords" />
                            <div class="input-group-append">
                                <button class="btn btn-secondary" type="button"
                                    (click)="showSuggestions('keywords', 'keyword', 'value')">...</button>
                            </div>
                        </div>
                    </label>

                    <label class="form-group">
                        <i18n class="control-label">Organization name</i18n>
                        <div class="input-group">
                            <input type="text" class="form-control"
                                [(ngModel)]="datasourceSelectorService.data.query.OrganisationName" />
                            <div class="input-group-append">
                                <button class="btn btn-secondary" type="button"
                                    (click)="showSuggestions('OrganisationName', 'org', 'name')">...</button>
                            </div>
                        </div>
                    </label>

                    <label class="form-group" [hidden]='true'>
                        <!-- TODO: wtf?-->
                        <i18n class="control-label">Type</i18n>
                        <select class="form-control" [(ngModel)]="datasourceSelectorService.data.query.type"
                            (change)='mickaFilterService.advancedMickaTypeChanged(mickaDatasetConfig, datasourceSelectorService.data.query.type)'>
                            <option value=""></option>
                            <option value="data" i18n>Data</option>
                            <option value="service" i18n>Service</option>
                            <option value="application" i18n>Application</option>
                            <option value="featureCatalogue" i18n>Feature catalogue</option>
                        </select>
                    </label>
                    <!--
                    <div class="form-group" [hidden]="query.type != 'application' && query.type != 'service'">
                        <label class="control-label" i18n>
                            <span [hidden]="query.type != 'application'">Application type:</span>
                            <span [hidden]="query.type != 'service'">Service type:</span>
                        </label>
                        <select class="form-control" [(ngModel)]="query.ServiceType">
                            <option *ngFor="let type of micka_ds.level2_types" [attr.value]="{{type.value}}">{{type.name}}</option>
                        </select>
                    </div>
                    -->

                    <label class="form-group" [hidden]="datasourceSelectorService.data.query.type != 'data'">
                        <i18n class="control-label">Topic category</i18n>

                        <select class="form-control" [(ngModel)]="datasourceSelectorService.data.query.TopicCategory">
                            <option *ngFor="let type of mickaFilterService.mickaDS.code_lists.topicCategory"
                                [attr.value]="type.value">{{type.name}}</option>
                        </select>
                    </label>

                    <label class="form-group" [hidden]="datasourceSelectorService.data.query.type != 'data'">
                        <i18n class="control-label">Scale</i18n> 1:
                        <select class="form-control" [(ngModel)]="datasourceSelectorService.data.query.Denominator">
                            <option value="2000">2000</option>
                            <option value="2500">2500</option>
                            <option value="2880">2880</option>
                            <option value="5000">5000</option>
                            <option value="6000">6000</option>
                            <option value="10000">10000</option>
                            <option value="100000">100000</option>
                        </select>
                    </label>


                    <label class="form-group" [hidden]='true'>
                        <!-- TODO: wtf?-->
                        <i18n class="control-label">Order by</i18n>
                        <select class="form-control" [(ngModel)]="datasourceSelectorService.data.query.sortby">
                            <option value="title" i18n>Title</option>
                            <option value="date" i18n>Date stamp</option>
                            <option value="bbox" i18n>Extent similarity</option>
                        </select>
                    </label>
                </form>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-primary" i18n
                    (click)="datasourceSelectorService.queryCatalogs(); modalVisible = false"
                    data-dismiss="modal">Search</button>
                <button type="button" class="btn btn-secondary" (click)="DS.clear()">
                    <i18n>Clear</i18n>
                </button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal"
                    (click)="DS.clear(); modalVisible = false" i18n>Close</button>
            </div>
        </div>
    </div>
</div>
