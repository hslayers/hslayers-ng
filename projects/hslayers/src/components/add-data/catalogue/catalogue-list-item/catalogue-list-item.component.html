<div class="d-flex flex-column">
    <div class="">
        <a data-toggle="tooltip" [title]="layer.abstract || ''">{{layer.title || layer.abstract}}</a>
    </div>
    <div class="hs-catalogue-item-body d-flex flex-column w-100 justify-content-around mt-2"
        *ngIf="hsAddDataCatalogueService.selectedLayer?.id === layer.id">
        <hr class="hs-dotted-line w-100 ">
        <div class="d-flex flex-row justify-content-around align-items-end">
            <a class="btn btn-sm border-0" [hidden]="selectTypeToAddLayerVisible"
                (click)="$event.stopPropagation();addLayerToMap(layer.endpoint, layer)">
                <i [hidden]="loadingInfo" class="material-icons material-icons icon-primary">add</i>
                <img [hidden]="!loadingInfo" [src]="hsConfig._ajaxLoaderPath" />
                <span class="ms-1">{{'DATASOURCE_SELECTOR.datasourceListItem.addToMap' |
                    translateHs }}</span>
            </a>
            <a class="btn btn-sm border-0" [title]="'DATASOURCE_SELECTOR.datasourceListItem.abortAdd' | translateHs "
                (click)="$event.stopPropagation();abortAdd()" [hidden]="!selectTypeToAddLayerVisible">
                <i class="material-icons text-danger">clear</i><span
                    class="ms-1">{{'DATASOURCE_SELECTOR.datasourceListItem.abortAdd' |
                    translateHs }}</span>
            </a>
            <a class="btn btn-sm border-0" (click)="showMetadata(layer.endpoint, layer)">
                <i class="material-icons material-icons icon-primary">info</i><span class="ms-1">{{'COMMON.metadata' |
                    translateHs }}</span>
            </a>
            <ng-container *ngIf="layer.endpoint?.authenticated">
                <a class="btn btn-sm border-0" (click)="$event.stopPropagation();showPermissions(layer)"
                    data-toggle="tooltip" data-placement="bottom"
                    [title]="layer.editable ? '' : 'DATASOURCE_SELECTOR.datasourceListItem.notAllowedToEditLayer' | translateHs ">
                    <i class="material-icons material-icons icon-primary" [ngClass]="{'text-muted': !layer.editable}"
                        [ngStyle]="{'cursor' : layer.editable ? 'pointer' : 'default'}">lock</i><span class="ms-1"
                        *ngIf="layer.editable">{{'COMMON.setPermissions' | translateHs }}</span>
                </a>
                <a class="btn btn-sm border-0" (click)="$event.stopPropagation();removeLayer(layer)"
                    data-toggle="tooltip" data-placement="bottom"
                    [title]="layer.editable ? '' : 'DATASOURCE_SELECTOR.datasourceListItem.notAllowedToEditLayer' | translateHs ">
                    <i class="material-icons text-danger" [ngClass]="layer.editable ? 'text-danger' : 'text-muted'"
                        [ngStyle]="{'cursor' : layer.editable ? 'pointer' : 'default'}">delete</i><span class="ms-1"
                        *ngIf="layer.editable">{{'COMMON.removeLayer' | translateHs }}</span>
                </a>
            </ng-container>
        </div>
    </div>
    <div class="d-none">
        <div class="p-0" [hidden]='hsAddDataCatalogueService.layerDownload(layer.endpoint,layer) === "#"'>
            <!-- TODO: Remove function call from template -->
            <a class="btn btn-sm border-0 btn-secondary"
                [href]='hsAddDataCatalogueService.layerDownload(layer.endpoint, layer)' data-toggle="tooltip"
                [title]="'COMMON.download' | translateHs "><i class="material-icons">download_for_offline</i></a>
        </div>
    </div>
</div>
<div>
    <!-- <div class="p-0" [hidden]="!selectTypeToAddLayerVisible || selectedType">
        <button type="button" class="btn btn-sm btn-danger" (click)="$event.stopPropagation();abortAdd()" data-toggle="tooltip"
            [title]="'DATASOURCE_SELECTOR.datasourceListItem.abortAdd' | translateHs ">
            <i class="material-icons icon-remove"></i>
        </button>
    </div> -->
    <div [hidden]="!loadingInfo" class="list-group-item text-primary text-center py-2">
        <span class="pe-2 hs-loader hs-loader-dark"></span>
        &emsp;{{'ADDDATA.CATALOGUE.loading' | translateHs }}
    </div>
    <div class="card bg-light align-items-center"
        [hidden]="!selectTypeToAddLayerVisible || loadingInfo || hsAddDataCatalogueService.selectedLayer?.id !== layer.id">
        <div class="d-flex flex-row justify-content-between align-items-center w-100">
            <div class="px-3">
                <span class="btn btn-sm disabled border-0" disabled="true" aria-disabled="true">{{
                    'ADDDATA.CATALOGUE.addAs' |
                    translateHs }}&nbsp;</span>
                <div class="btn-group btn-group-toggle h-100 pe-2 align-items-center" data-toggle="buttons">
                    <label class="btn btn-sm btn-outline-secondary" *ngFor="let type of whatToAddTypes"
                        style="width:6em" (click)="selectTypeAndAdd(type,$event)">
                        {{type}}
                    </label>
                </div>
            </div>
            <div>
                <a class="btn btn-sm border-0" (click)="$event.stopPropagation();toggleExplanations()"
                    [title]="'DATASOURCE_SELECTOR.datasourceListItem.whatDoesItMean' | translateHs ">
                    <i class="material-icons text-primary">help</i>
                </a>
            </div>
        </div>
        <div class="d-flex">
            <ul class="ms-auto p-2 list-unstyled" [hidden]="!explanationsVisible">
                <li class="text-secondary small" *ngFor="let type of whatToAddTypes">
                    {{type}} &ndash; {{translateString('ADDDATA.CATALOGUE.DESC', type)}}
                    <!-- TODO: Remove function call from template -->
                </li>
            </ul>
        </div>
    </div>

</div>