<div class="card hs-main-panel">
    <div class="mt-3 mx-3 pl-1 d-flex justify-content-between">
        <div class="input-group w-50">
            <input type="search" class="form-control w-50" [placeholder]="'COMMON.search' | translate" name="search"
                [(ngModel)]="data.query.textFilter" (ngModelChange)="queryByFilter()">
            <div class="input-group-append">
                <button class="btn input-group-text text-secondary hs-light-background border-left-0"
                    (click)="queryByFilter()">
                    <i class="icon-search icon-primary"></i>
                </button>
            </div>
        </div>
        <hs-layman-current-user [endpoint]="HsLaymanService.getLaymanEndpoint()"></hs-layman-current-user>
    </div>
    <div class="d-flex ml-4 mr-3 justify-content-between py-1 ">
        <div class="d-flex">
            <div class="input-group-text border-0 pl-0">
                <input type="checkbox" [(ngModel)]="data.filterByExtent"  (change)="extentFilterChanged()"
                    name="filterByExtent">
                <span class="ml-1">{{'COMPOSITIONS.filterByMap' | translate}}</span>
            </div>
            <div class="input-group-text border-0" [hidden]="!HsLaymanService.getLaymanEndpoint()">
                <input type="checkbox" [(ngModel)]="data.onlyMine" (ngModelChange)="queryByFilter()" name="onlyMine">
                <span class="ml-1">{{'COMPOSITIONS.onlyMine' | translate}}</span>
            </div>
        </div>
        <div class="position-relative">
            <button class="btn btn-light hs-white-background dropdown-toggle hs-custom-toggle" data-toggle="dropdown"
                type="button" (click)="filterTypeMenu = !filterTypeMenu"> More
            </button>
            <div class="dropdown-menu dropdown-menu-right px-3" [ngClass]="{'show': filterTypeMenu}">
                <div class="d-flex flex-row">
                    <div>
                        <h6 class="dropdown-header">{{'ADDDATA.CATALOGUE.filterType' | translate}}</h6>
                        <div class="dropdown-menu-item m-2" *ngFor="let type of textFieldTypes; let index = index"
                            [title]="'ADDDATA.CATALOGUE.selectFilterType' | translate">
                            <input class="d-none" type="checkbox" [(ngModel)]="data.textField"
                                (change)="selectType(type)" [attr.id]="'textfield-'+index" name="textfield-{{index}}" />
                            <label class="form-check-label m-0 pl-4 mw-100 d-flex align-items-center"
                                [attr.for]="'textfield-'+index"
                                [ngClass]="{'hs-checkmark': data.textField == type,'hs-uncheckmark':data.textField != type}"><span
                                    class="ml-2"
                                    style="max-width: 90%;">{{translateString('ADDDATA.CATALOGUE.searchFilterTypes',
                                    type)}}</span></label>
                        </div>
                    </div>
                    <div>
                        <h6 class="dropdown-header">{{'ADDDATA.CATALOGUE.resourceType' | translate}}</h6>
                        <div class="dropdown-menu-item m-2" *ngFor="let type of dataTypes; let index = index"
                            [title]="'ADDDATA.CATALOGUE.selectFilterType' | translate">
                            <input class="d-none" type="checkbox" [(ngModel)]="data.query.type" (change)="selectQueryType(type, 'type')"
                                [attr.id]="'type-'+index" name="type-{{index}}" />
                            <label class="form-check-label m-0 pl-4 mw-100 d-flex align-items-center" [attr.for]="'type-'+index"
                                [ngClass]="{'hs-checkmark': data.query.type == type,'hs-uncheckmark':data.query.type != type}"><span
                                    class="ml-2" style="max-width: 90%;">{{translateString('ADDDATA.CATALOGUE.queryDataTypes',
                                    type)}}</span></label>
                            </div>
                    </div>
                    <div>
                        <h6 class="dropdown-header">{{'COMMON.sortBy' | translate}}</h6>
                        <div class="dropdown-menu-item m-2" *ngFor="let sortType of sortbyTypes; let index = index"
                            [title]="'ADDDATA.CATALOGUE.selectFilterType' | translate">
                            <input class="d-none" type="checkbox" [(ngModel)]="data.query.sortby" (change)="selectQueryType(sortType, 'sortby')"
                                [attr.id]="'sortType-'+index" name="sortType-{{index}}" />
                            <label class="form-check-label m-0 pl-4 mw-100 d-flex align-items-center" [attr.for]="'sortType-'+index"
                                [ngClass]="{'hs-checkmark': data.query.sortby == sortType,'hs-uncheckmark':data.query.sortby != sortType}"><span
                                    class="ml-2" style="max-width: 90%;">{{translateString('ADDDATA.CATALOGUE.sortbyTypes',
                                    sortType)}}</span></label>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <div class="tab-content">
        <div class="card">
            <div class="card-body">
                <!-- <div *ngIf="endpoint.type == 'micka'">
                        <hs-micka-filters micka-dataset-config="{url: endpoint.url}"></hs-micka-filters>
                    </div>
                     -->
                <ul class="list-group">
                    <li class='list-group-item text-primary text-center py-2'
                        [hidden]="!HsAddDataCatalogueService.layersLoading"><img class="pr-2"
                            [src]="loaderImage" />{{'ADDDATA.CATALOGUE.loading' | translate}}</li>
                    <li [hidden]='HsAddDataCatalogueService.catalogEntries.length > 0 || HsAddDataCatalogueService.layersLoading'
                        class='list-group-item '>
                        {{'DATASOURCE_SELECTOR.noResults' | translate}}</li>
                    <li [hidden]="HsAddDataCatalogueService.layersLoading"
                        *ngFor='let layer of HsAddDataCatalogueService.catalogEntries' class="clearfix py-2"
                        [ngClass]="'list-group-item'+(layer.highlighted ? ' active' : '')"
                        (mouseover)="highlightLayer(layer, true)" (mouseleave)="highlightLayer(layer, false)">
                        <hs-add-data-list-item [layer]="layer"></hs-add-data-list-item>
                    </li>
                </ul>
            </div>

            <div class="card-footer"
                *ngIf="HsAddDataCatalogueService.matchedLayers != 0 && !HsAddDataCatalogueService.layersLoading">
                <ul class="pagination d-flex justify-content-center">
                    <li class="page-item" [ngClass]="{'disabled': HsAddDataCatalogueService.listStart == 0 }">
                        <a class="page-link" (click)="getPreviousRecords()"><span
                                aria-hidden="true">&laquo;</span></a>
                    </li>
                    <li class="page-item"
                        *ngIf="resultsVisible() && HsAddDataCatalogueService.listNext != HsAddDataCatalogueService.matchedLayers">
                        <span class="page-link">
                            {{'COMMON.results' | translate}}
                            {{HsAddDataCatalogueService.listStart + 1}} -
                            {{HsAddDataCatalogueService.listNext}}</span>
                    </li>
                    <li class="page-item"
                        *ngIf="resultsVisible() && HsAddDataCatalogueService.listNext == HsAddDataCatalogueService.matchedLayers">
                        <span class="page-link">
                            {{'COMMON.results' | translate}}
                            {{HsAddDataCatalogueService.listStart + 1}} -
                            {{HsAddDataCatalogueService.matchedLayers}}</span>
                    </li>
                    <li class="page-item" [ngClass]="{'disabled': !nextPageAvailable() }">
                        <a class="page-link" (click)="getNextRecords()"><span
                                aria-hidden="true">&raquo;</span></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>
